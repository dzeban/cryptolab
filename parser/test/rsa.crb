/*Реализация криптосистемы RSA на одной вычислителной машине*/

Field F{int};                                   //Создаем поле F
p<-F{len > 1000b};                              //Берем случайный элемент p из поля F длиной больше 1000 бит
q<-F{len > 2000b};
n = p*q;                                        //n = произведение p на q
fi = phi(p,q);                                  //fi = функция эйлера от аргументов p и q
e<-[1,fi-1];                                    //Берем случайное e из промежутка от 1 до fi-1
d = mul_inv(e,fi);                              //d = мультипликативно обратное от e по модулю fi
echo "Please type number to encrypt:";          //просим пользователя ввести сообщение
m = scan(stdin);                                //считываем с клавиатуры
c = m^e(mod n);                                 //шифруем: с = m в степени e по модулю n
mm = c^d(mod n);                                //расшифровываем
if (mm == m) echo "Perfect\n";
	//else echo "Error\n";
