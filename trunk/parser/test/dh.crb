/*Реализация протокола установления ключа Диффи-Хеллмана на одной вычислительной машине*/

Field F{int,order(p=0x222)};                    //Создаем поле F порядка 0x2222
a<-F{len > 10B};                                //Берем случайный элемент a из поля F длиной больше 10 байт
Group G{mul(F),gen(a)};                         //Создаем группу G из поля F с образующей a (это макрос)
x<-[1,a];                                       //Берем случайное x из промежутка от 1 до a
ax = a^x(mod p);                                //ax = a в степени x по модулю p
y<-[1,a];
ay = a^y(mod p);
key_a = ax^y(mod 2^64);                         //Вычисляем ключи
key_b = ay^x(mod 2^64);
if(key_a == key_b) echo "Perfect\n";            //сравниваем полученные ключи
        else echo "Error\n";
